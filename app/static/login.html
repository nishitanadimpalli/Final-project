<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
</head>
<body>
    <h1>Login</h1>

    <label>
        Email:
        <input type="email" id="email">
    </label>
    <br>

    <label>
        Password:
        <input type="password" id="password">
    </label>
    <br>

    <button onclick="doLogin()">Login</button>

    <p id="message"></p>

    <p>
        Donâ€™t have an account?
        <a href="/register-page">Go to Register</a>
    </p>

    <script>
        async function doLogin() {
            const email = document.getElementById("email").value.trim();
            const password = document.getElementById("password").value.trim();
            const messageEl = document.getElementById("message");

            if (!email || !password) {
                messageEl.textContent = "Please fill email and password.";
                return;
            }

            try {
                const response = await fetch("/auth/login", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json().catch(() => ({}));

                if (!response.ok) {
                    messageEl.textContent = data.detail || "Login failed.";
                    return;
                }

                // Save token for later (stats, calculations, etc.)
                if (data.access_token) {
                    localStorage.setItem("access_token", data.access_token);
                }

                messageEl.textContent = "Login successful!";
                // Optionally navigate after a short delay:
                // setTimeout(() => { window.location.href = "/calculations-page"; }, 1000);
            } catch (err) {
                console.error(err);
                messageEl.textContent = "Network error.";
            }
        }
    </script>
</body>
</html>
